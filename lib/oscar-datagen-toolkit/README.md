# OSCAR Datagen Toolkit

This repository contains a set of tools for generating synthetic datasets using the CARLA Simulator. [CARLA](https://carla.org/) is an open-source simulator for autonomous driving research that provides realistic urban environments, dynamic traffic, and realistic sensors.

## Requirements

- [Docker](https://github.com/intel-sandbox/carla-datagen-toolkit/wiki/Setup-Docker)

If you want to install the tools outside of the Docker container, build and install the CARLA Python package before install the tools:

```
cd docker

# build the CARLA client
# NOTE: Specify the Python3 version you want to use
./build --python-version=3.9

# install CARLA
pip install build/carla/PythonAPI/carla/dist/carla-0.9.13-cp39-cp39-linux_x86_64.whl
```

## Getting started

- With Docker:

1. Clone this repository to your local machine.
2. Run `make docker_image` to build the Docker image with all the dependencies needed to run these tools.

- Manual installation

1. Run the following command:

```
pip install .
```

**Note**: In this case, make sure that you have a running CARLA server to connect with.

> \[Optional\] Install the pre-commit hook:

```
pip install pre-commit==2.20.0

# To run the hook on every commit
pre-commit install

# To run it manually
pre-commit run -a
```

## Tools

The following tools are included in this repository:

### oscar_data_saver.py

This script sets up a CARLA simulation under certain parameters specified in one of the YAML's configuration files located at **configs/simulation**, and then proceed with collection of the data from the sensors included in that simulation. To use this script run:

```
SIMULATION=<SIM-NAME> make simulation
```

where `SIM-NAME` is replaced with the name of the simulation that is going to be used.

### oscar_data_annotator.py

This script takes the data previously generated by the **oscar_data_saver.py** tool and creates COCO- or MOTS-compatible datasets. The following is an example of how to use this tool:

```
UUID=3947a3d5-9089-4526-ae84-cabccf0de534 ANNOTATION=kwcoco make annotation
```

where:

- UUID: unique identifier for the data collection run. This is auto-generated by the **oscar_data_saver.py** tool.
- ANNOTATION: type of annotation that is going to be generated (*kwcoco*, *mots_txt* or *motx_png*).
